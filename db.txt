struct company {
  field name text;
  field id int rowid;
  field hash password;
  comment "Controlling organisation.";
}

struct user {
  field company struct cid:company.id;
  field cid;
  field hash password;
  field hash2 password;
  field email text unique;
  field name text comment "Full name.";
  field uid int rowid;
  list cid;
  iterate name: comment
    "Search for users by full name.";
  update cid: uid;
  update hash, hash2: cid;
  search company.hash,email,hash;
  list company.hash,name,hash;
  iterate company.hash,name,hash;
  comment "A regular user.";
}

struct session { 
  field user struct userid:user.uid;
  field userid int comment "Associated user.";
  field token int comment "Random cookie.";
  field mtime int;
  field id int rowid;
  iterate user.company.name,mtime: name foo comment 
    "Search for company's logged-in users.";
  comment "Authenticated session.";
}
